# iShopDev Mall 一站式电商解决方案

> 该仓库整合了后台管理、移动端商城、小程序，以及自助收银等多个终端，并提供基于 Spring Cloud 微服务的后端。本文档旨在让新成员能快速在 **Windows** 环境完成本地开发、调试与部署。

## 目录

1. 项目总览
2. 系统架构
3. 环境准备
4. 后端（mall-swarm）
5. 管理后台（mall-admin-web）
6. 移动端 / 小程序（mall-app-web）
7. 自助收银（mall-self-checkout）
8. 常见问题
9. 参考链接

---

## 1 项目总览

| 目录                    | 说明                         | 主要技术栈                           |
| ----------------------- | ---------------------------- | ------------------------------------ |
| mall-swarm              | **Spring Cloud** 微服务后端  | Spring Boot 3 / Sa-Token / MyBatis 等 |
| mall-admin-web          | 运营后台 SPA                 | Vue 2 / Element UI                   |
| mall-app-web            | H5 / 小程序 / App 壳         | uni-app (Vue 2)                      |
| mall-self-checkout      | 自助收银（桌面+Android）     | Vue 3 / Electron / Capacitor         |

项目各模块之间通过 **mall-swarm 网关 (Spring Cloud Gateway)** 进行 API 调用，统一口径为：

```
http://localhost:8201/<service-name>/<actual-path>
```

---

## 2 系统架构

### 整体架构图

```
┌─────────────────────────────────────────────────────────────────────────┐
│                           客户端层                                       │
│     ┌───────────┐    ┌───────────┐    ┌───────────┐    ┌───────────┐   │
│     │ 小程序端   │    │   H5端    │    │  管理后台  │    │ 自助收银   │   │
│     │mall-app   │    │mall-app   │    │mall-admin │    │mall-self  │   │
│     └───────────┘    └───────────┘    └───────────┘    └───────────┘   │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                          API 网关层                                      │
│                    mall-gateway (Spring Cloud Gateway)                  │
│              路由转发 / 负载均衡 / 认证鉴权 / 限流熔断                     │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                         微服务应用层                                     │
│  ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐ │
│  │mall-admin │ │mall-portal│ │mall-search│ │mall-auth  │ │mall-self  │ │
│  │ 后台服务   │ │ 前台服务   │ │ 搜索服务   │ │ 认证服务   │ │ check服务 │ │
│  └───────────┘ └───────────┘ └───────────┘ └───────────┘ └───────────┘ │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                         基础设施层                                       │
│  ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐ │
│  │   Nacos   │ │   Redis   │ │   MySQL   │ │ RabbitMQ  │ │Elasticsearch│
│  │ 注册/配置  │ │   缓存    │ │  数据库   │ │  消息队列  │ │  搜索引擎  │ │
│  └───────────┘ └───────────┘ └───────────┘ └───────────┘ └───────────┘ │
└─────────────────────────────────────────────────────────────────────────┘
```

### 业务功能概览

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          电商业务功能                                    │
├─────────────────────────────────────────────────────────────────────────┤
│  用户端功能                                                              │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│  │ 商品浏览 │ │ 购物车  │ │ 订单管理 │ │ 会员中心 │ │ 积分签到 │           │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘           │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│  │ AI定制  │ │ 优惠券  │ │ 支付结算 │ │ 售后服务 │ │ 分销推广 │           │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘           │
├─────────────────────────────────────────────────────────────────────────┤
│  管理端功能                                                              │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│  │ 商品管理 │ │ 订单管理 │ │ 会员管理 │ │ 营销管理 │ │ 权限管理 │           │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘           │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│  │ 库存管理 │ │ 统计分析 │ │ 内容管理 │ │ 系统设置 │ │ 财务管理 │           │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘           │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 3 环境准备

| 类型 | 工具 & 版本 | 说明 |
| ---- | ----------- | ---- |
| JDK  | 17          | 后端运行所需 |
| Node | ≥ 16.x      | 前端构建工具 |
| Maven| ≥ 3.8.x     | 后端构建工具 |
| HBuilder X | App 开发版 | 仅 *mall-app-web* 必需 |
| Android SDK | 31+ | 打包自助收银 APK 时需要 |

> **Windows 注意事项**：所有脚本均提供了 `*.ps1` 或 `*.bat` 版本，直接在 **PowerShell** 中执行即可。

---

## 4 后端（mall-swarm）

### 4.1 模块结构

```lua
mall-swarm
├── mall-common                   -- 工具类及通用代码模块
├── mall-mbg                      -- MyBatisGenerator生成的数据库操作代码模块
├── mall-auth                     -- 基于Sa-Token的统一认证中心
├── mall-gateway                  -- 基于Spring Cloud Gateway的微服务API网关
├── mall-monitor                  -- 基于Spring Boot Admin的微服务监控中心
├── mall-admin                    -- 后台管理系统服务
├── mall-search                   -- 基于Elasticsearch的商品搜索系统服务
├── mall-portal                   -- 移动端商城系统服务
├── mall-selfcheck                -- 自助收银系统服务
└── config                        -- 配置中心存储的配置
```

### 4.2 技术选型

| 技术 | 说明 |
| --- | --- |
| Spring Cloud 2023 | 微服务框架 |
| Spring Cloud Alibaba | 微服务组件 |
| Spring Boot 3.2 | 容器+MVC框架 |
| Sa-Token | 认证和授权框架 |
| MyBatis | ORM框架 |
| Elasticsearch | 搜索引擎 |
| RabbitMQ | 消息队列 |
| Redis | 分布式缓存 |
| Nacos | 注册中心/配置中心 |

### 4.3 快速启动

```powershell
cd mall-swarm
mvn clean package -DskipTests

# 依次启动以下模块
mall-auth      # 认证服务
mall-gateway   # 网关服务
mall-admin     # 后台服务
mall-portal    # 前台服务
mall-selfcheck # 自助收银服务
```

### 4.4 数据库与中间件

1. 创建数据库并导入脚本：`sql/mall.sql`
2. 安装并启动 Redis、RabbitMQ、Elasticsearch7、Nacos、MinIO

### 4.5 服务访问地址

| 服务 | 地址 | 说明 |
| --- | --- | --- |
| Nacos 控制台 | http://localhost:8848/nacos | 注册中心/配置中心 |
| 监控中心 | http://localhost:8101 | Spring Boot Admin |
| API 文档 | http://localhost:8201/doc.html | Knife4j 文档 |
| 网关服务 | http://localhost:8201 | API 网关入口 |

详细配置请查阅 `mall-swarm/README.md`。

---

## 5 管理后台（mall-admin-web）

### 5.1 功能模块

| 模块 | 功能说明 |
| --- | --- |
| 商品管理 (PMS) | 商品CRUD、分类、品牌、属性、库存、报损管理 |
| 订单管理 (OMS) | 订单查询、发货、退款、售后、运费模板 |
| 会员管理 (UMS) | 会员信息、等级、积分、标签、分销管理 |
| 营销管理 (SMS) | 优惠券、秒杀、广告、积分商城、签到 |
| 权限管理 | 管理员、角色、菜单、资源管理 |
| 数据统计 | 首页大屏、销售统计、商品统计、会员统计 |

### 5.2 技术选型

| 技术 | 说明 |
| --- | --- |
| Vue 2 | 前端框架 |
| Element UI | UI 框架 |
| Vuex | 状态管理 |
| ECharts / DataV | 数据可视化 |
| Webpack | 构建工具 |

### 5.3 本地调试

```powershell
cd mall-admin-web
npm install
npm run dev
```

访问地址：http://localhost:8090

### 5.4 生产构建

```powershell
npm run build:prod
```

详细配置请查阅 `mall-admin-web/README.md`。

---

## 6 移动端 / 小程序（mall-app-web）

### 6.1 功能模块

| 模块 | 功能说明 |
| --- | --- |
| 首页门户 | 轮播广告、分类导航、推荐商品、签到入口 |
| 商品功能 | 商品搜索、分类、详情、收藏、浏览历史 |
| 购物车 | 商品管理、数量修改、优惠券、结算 |
| 订单管理 | 创建订单、支付、物流跟踪、售后申请 |
| 会员中心 | 个人信息、地址、积分、优惠券、收藏 |
| AI定制 | 模板选择、图片上传、AI生成、效果预览 |
| 积分商城 | 商品兑换、优惠券兑换、兑换记录 |
| 签到系统 | 每日签到、连续签到、积分奖励 |
| 分销中心 | 邀请好友、推广记录、收益明细 |

### 6.2 技术选型

| 技术 | 说明 |
| --- | --- |
| uni-app | 跨平台前端框架 |
| Vue 2 | 核心框架 |
| Vuex | 状态管理 |
| luch-request | HTTP 请求 |

### 6.3 支持平台

- 微信小程序（主要）
- H5 移动端网页
- App (iOS/Android)
- 支付宝/百度/字节小程序

### 6.4 HBuilder X 运行

1. 打开 HBuilder X，选择"导入 -> 现有项目"并指向 `mall-app-web`
2. 运行到浏览器（Chrome）或微信小程序模拟器

默认调试端口：`8060`

详细配置请查阅 `mall-app-web/README.md`。

---

## 7 自助收银（mall-self-checkout）

### 7.1 功能特性

| 功能 | 说明 |
| --- | --- |
| 会员/非会员结算 | 支持两种结算模式 |
| 多种登录方式 | 手机号验证码、会员码扫描 |
| 商品扫码 | 条码识别、商品信息查询 |
| 购物车管理 | 商品添加、数量修改 |
| 多种支付方式 | 微信支付、支付宝、余额支付 |
| 小票打印 | 订单小票打印 |
| TTS 语音播报 | 语音提示功能 |

### 7.2 技术选型

| 技术 | 说明 |
| --- | --- |
| Vue 3 | 前端框架 |
| TypeScript | 类型安全 |
| Vite | 构建工具 |
| Pinia | 状态管理 |
| Vant 4 | 移动端 UI |
| Electron | 桌面端框架 |
| Capacitor | 移动端框架 |

### 7.3 支持平台

- Windows 桌面端 (Electron)
- Android 移动端 (Capacitor)
- Web 浏览器 (H5)

### 7.4 运行命令

```powershell
cd mall-self-checkout
npm install

# Web 开发模式
npm run dev

# Electron 开发模式
npm run dev:electron

# 构建 Windows 应用
npm run build:win

# 构建 Android 应用
npm run build:android
```

详细配置请查阅 `mall-self-checkout/README.md`。

---

## 8 常见问题 FAQ

| 问题 | 解决方案 |
| ---- | -------- |
| 前端 400 Bad Request | 确认后端接口使用 `@RequestParam` 时，前端应发送 **form-data / query 参数** 而非 JSON |
| 网关/后端认证失败 | 保证 mall-admin 与网关 Redis 配置一致，且网关不做 Sa-Token 认证 |
| Docker 容器无法访问宿主机 MySQL | 检查 `docker-compose-env.yml` 中端口映射及 MySQL 配置，确认网络连通 |
| Elasticsearch 搜索异常 | 首次使用需安装 IK 分词器，见 `mall-swarm/README.md` |

---

## 9 参考链接

| 子项目 | README 文档 |
| --- | --- |
| mall-swarm | [mall-swarm/README.md](./mall-swarm/README.md) |
| mall-admin-web | [mall-admin-web/README.md](./mall-admin-web/README.md) |
| mall-app-web | [mall-app-web/README.md](./mall-app-web/README.md) |
| mall-self-checkout | [mall-self-checkout/README.md](./mall-self-checkout/README.md) |

---

> 本 README 仅作团队内部使用，若有疑问请联系维护者或查阅各子项目 README。
